Bootstrap: docker
From: ubuntu:24.04

# Install build tools and some needed dependencies  
# apt-get is the package manager (i.e : most commonly used tool to install software) 
# of debian and all debian-based distribution (such as Ubuntu) 
%post -c /bin/bash
    apt-get -u update
    apt-get install -y wget gnupg2 bash gcc gfortran libopenblas-openmp-dev libomp-dev cmake pkg-config meson ninja-build git
    
    # --------------     GNU COMPILERS       -------------- #
    # install open source alternatives

    # Download the source code
    cd /opt
    wget https://github.com/grimme-lab/xtb/archive/refs/tags/bleed.tar.gz --no-check-certificate
    tar -xf bleed.tar.gz
    cd xtb-bleed

    # set env variable
    # Check xtb documentation to see what need to be modified here
    export FC=gfortran
    export CC=gcc
    export GIT_SSL_NO_VERIFY=1
    meson setup build --buildtype=release -Dlapack=openblas

    ninja -C build

%environment
    export PATH="$PATH:/opt/xtb-bleed/build/"

%runscript
    /opt/xtb-bleed/build/xtb $*
